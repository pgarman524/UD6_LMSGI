<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;8.&nbsp;Support of EXPath Packages</title><link rel="stylesheet" href="html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.73.1"><link rel="start" href="index.html" title="Qizx Manual"><link rel="up" href="admin_guide.html" title="Part&nbsp;II.&nbsp;User's Guide"><link rel="prev" href="std_fulltext.html" title="Chapter&nbsp;7.&nbsp;Support of standard XQuery Full-Text"><link rel="next" href="indexing.html" title="Chapter&nbsp;9.&nbsp;Configuring the indexing process"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;8.&nbsp;Support of EXPath Packages</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="std_fulltext.html">Prev</a>&nbsp;</td><th width="60%" align="center">Part&nbsp;II.&nbsp;User's Guide</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="indexing.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="d0e3747"></a>Chapter&nbsp;8.&nbsp;Support of EXPath Packages</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="ch08.html#d0e3813">1. Installing EXPath Packages</a></span></dt><dd><dl><dt><span class="sect2"><a href="ch08.html#d0e3897">1.1. Installation in Qizx Server</a></span></dt></dl></dd><dt><span class="sect1"><a href="ch08.html#d0e3925">2. Using Packages in Qizx</a></span></dt></dl></div><p>Qizx 4.2 introduces support for the <a class="ulink" href="http://www.expath.org" target="_top">EXPath</a> initiative:</p><div class="itemizedlist"><ul type="disc"><li><p>EXPath defines a generic mechanism for extending a XQuery processor with <span class="emphasis"><em>Packages</em></span> (in fact EXPath defines Packages for XSLT2 and XProc processors too).</p><p>Packages are self-contained, easily deployable extensions to XML processors.</p></li><li><p>EXPath proposes a few standard Packages: zip-file handling functions, HTTP-client API etc.</p><p>EXPath's aims at defining and offering a standard set of API's for XQuery application development, and to extend it gradually.</p></li></ul></div><p>Generally speaking, an EXPath Package can simply define XQuery functions or XSLT templates, but it can also be Processor-specific and extend the processor within built-in functions and various add-ons.</p><p>In Qizx, a Package can define:</p><div class="itemizedlist"><ul type="disc"><li><p>a set of XQuery functions (i.e an XQuery Module).</p><p>For example Priscilla Walmsley's <span class="bold"><strong>FunctX</strong></span> library has been packaged in such a way.</p></li><li><p>XSLT templates</p></li><li><p>Built-in XQuery functions:</p><p>Such modules contain code that plug new built-in extension functions.</p><p>For example the EXPath <span class="bold"><strong>zip</strong></span> module is provided with a Qizx-specific implementation.</p></li><li><p>Add-ons:</p><p>For example, Qizx 4.2 provides a module <span class="bold"><strong>html5-importer</strong></span> which allows importing HTML5 documents. either in XQuery or through the Java API.</p><p>Other content importers will be available in future versions: csv, Mime mail etc</p></li></ul></div><p>Note that a Package can contain simultaneously all these kinds of resources. So this mechanism allows distributing a whole application in a single Package.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Tip</h3><p>Qizx Packages can be downloaded from: <a class="ulink" href="http://www.axyana.com/expackages.shtml" target="_top">http://www.axyana.com/expackages.html</a> .</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3813"></a>1.&nbsp;Installing EXPath Packages</h2></div></div></div><p>EXPath Packaging comes with a command-line tool xrepo which performs management tasks for a Repository.</p><p>This tool is available in the Qizx distribution at QIZX-DISTRIB/bin/xrepo, a Unix version and a Windows version xrepo.bat .</p><div class="variablelist"><dl><dt><span class="term">Get the package(s):</span></dt><dd><p>packages come as .xar files.</p><div class="itemizedlist"><ul type="disc"><li><p>Official source for Qizx Packages: <a class="ulink" href="http://www.axyana.com/expackages.shtml" target="_top">http://www.axyana.com/expackages.html</a> .</p></li><li><p>CXAN, a common repository for EXPath packages: <a class="ulink" href="http://cxan.org/" target="_top">http://cxan.org/</a></p><p>NB: CXAN is not always up-to-date.</p></li></ul></div></dd><dt><span class="term">Create a Package Repository</span></dt><dd><p>A Package Repository is a directory where Packages are installed:</p><pre class="programlisting">&gt; xrepo create <span class="emphasis"><em>myrepository</em></span></pre><p>This command creates a Repository that will be used by applications.</p></dd><dt><span class="term">Install a Package</span></dt><dd><pre class="programlisting">&gt; xrepo --repo <span class="emphasis"><em>myrepository</em></span> install <span class="emphasis"><em>package.xar</em></span></pre></dd><dt><span class="term">List installed Packages</span></dt><dd><p>To check that a package is installed, use the following command:</p><pre class="programlisting">&gt; xrepo --repo <span class="emphasis"><em>myrepository</em></span> list
http://example.org/hello-world
  1.0.0, in hello-world-1.0.0
http://expath.org/ns/zip
  1.0.0, in zip-qizx-1.0.0
http://www.functx.com/functx
  1.0.0, in functx-1.0.0</pre><p>For each package, this command lists its namespace URI, its version and its name.</p></dd><dt><span class="term">Remove an installed Package</span></dt><dd><pre class="programlisting">&gt; xrepo --repo <span class="emphasis"><em>myrepository</em></span> remove <span class="emphasis"><em>package_namespace</em></span></pre><p>This command will ask for confirmation before deleting the package.</p><p>For example to remove the FunctX package:</p><pre class="programlisting">&gt; xrepo --repo <span class="emphasis"><em>myrepository</em></span> remove http://www.functx.com/functx</pre></dd></dl></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e3897"></a>1.1.&nbsp;Installation in Qizx Server</h3></div></div></div><p>In Qizx Server, there is an EXPath Repository defined by default:</p><p>If <span class="emphasis"><em>Qizx_Server_Root </em></span>is the server storage directory, then the EXPath Repository is located at <span class="emphasis"><em>Qizx_Server_Root</em></span>/xpkg_repository.</p><pre class="programlisting">&gt; xrepo --repo <span class="emphasis"><em>Qizx_Server_Root/xpkg_repository</em></span> install <span class="emphasis"><em>package</em></span></pre><p>This location can be changed in the configuration of the server (qizx-server.conf).</p><p>Notice that adding a package is currently manual and requires a restart of the Qizx server to be taken into account.</p><h4><a name="d0e3921"></a>Security issues:</h4><p>Some packages needs to load Jar files dynamically (from the package contents). This might be prohibited by the Servlet Container's security policy. This is a system- and configuration-dependent issue that cannot be addressed here.</p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e3925"></a>2.&nbsp;Using Packages in Qizx</h2></div></div></div><p>As of version 4.2, Packages are supported in Qizx Studio and the command-line tool <span class="guilabel">qizx</span>.</p><p>To run Qizx Studio or <span class="guilabel">qizx</span> using a Repository, use the -xrepo option:</p><pre class="programlisting">qizxstudio -xrepo <em class="replaceable"><code>my-repository</code></em> <em class="replaceable"><code>arguments</code></em>...</pre><pre class="programlisting">qizx -xrepo <em class="replaceable"><code>my-repository</code></em> <em class="replaceable"><code>arguments</code></em>...</pre><p>An alternative is to set the environment variable <span class="bold"><strong>EXPATH_REPO</strong></span> to the (absolute) path of the Repository.</p><p>&nbsp;</p><h3><a name="d0e3961"></a>Using XQuery Modules from Packages:</h3><p>Reminder: in XQuery, a module is imported through a <em class="glossterm">namespace URI</em> that is resolved by the XQuery processor in an "implementation-dependent" way. In addition, it is possible to specify <em class="glossterm">location hints</em>, that may help the processor to effectively locate the XQuery module.</p><p>For example, if the Packaging system were not used, one could have to specify a location explicitly, which is cumbersome and not portable:</p><pre class="programlisting">import module namespace zip = "http://expath.org/ns/zip" <span class="bold"><strong>at "wherever/zip.xq"</strong></span>; 

zip:entries('sample.zip')</pre><p>The purpose of EXPath Packaging is precisely to define a method for importing modules that is <span class="emphasis"><em>independent of any implementation</em></span>.</p><p>Therefore the module import only uses the Namespace URI specific to the module. The Packaging system is in charge of resolving this URI by looking for a mapping inside the package.</p><p>Thus we would write:</p><pre class="programlisting">import module namespace zip = "http://expath.org/ns/zip"; 

zip:entries('sample.zip')</pre></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="std_fulltext.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="admin_guide.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="indexing.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;7.&nbsp;Support of standard XQuery Full-Text&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;9.&nbsp;Configuring the indexing process</td></tr></table></div></body></html>