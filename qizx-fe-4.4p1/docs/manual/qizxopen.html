<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Appendix&nbsp;A.&nbsp;Qizx/open Manual</title><link rel="stylesheet" href="html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.73.1"><link rel="start" href="index.html" title="Qizx Manual"><link rel="up" href="index.html" title="Qizx Manual"><link rel="prev" href="qizxstudio.html" title="Qizx Studio Help"><link rel="next" href="glossary.html" title="Glossary"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Appendix&nbsp;A.&nbsp;Qizx/open Manual</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="qizxstudio.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="glossary.html">Next</a></td></tr></table><hr></div><div class="appendix" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="qizxopen"></a>Appendix&nbsp;A.&nbsp;Qizx/open Manual</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="qizxopen.html#d0e13487">1. Getting Started with Qizx/open</a></span></dt><dd><dl><dt><span class="section"><a href="qizxopen.html#d0e13511">1.1. Writing and running queries with Qizx Studio</a></span></dt><dt><span class="section"><a href="qizxopen.html#d0e13648">1.2. Running queries with the qizx command line tool</a></span></dt></dl></dd><dt><span class="section"><a href="qizxopen.html#d0e13684">2. Programming with the Qizx/open API</a></span></dt><dd><dl><dt><span class="section"><a href="qizxopen.html#d0e13691">2.1. Compiling and running the code samples</a></span></dt><dt><span class="section"><a href="qizxopen.html#d0e13712">2.2. Creating a work session</a></span></dt><dt><span class="section"><a href="qizxopen.html#d0e13750">2.3. Compiling and executing queries</a></span></dt><dd><dl><dt><span class="section"><a href="qizxopen.html#d0e13995">2.3.1. Compiling and running the code of this lesson</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="qizxopen.html#qop_diffs">3. Differences between Qizx/open and Qizx</a></span></dt><dd><dl><dt><span class="section"><a href="qizxopen.html#d0e14159">3.1. Java API</a></span></dt><dt><span class="section"><a href="qizxopen.html#qop_fun_doc">3.2. Function fn:doc()</a></span></dt><dt><span class="section"><a href="qizxopen.html#qop_fun_collection">3.3. Function fn:collection()</a></span></dt></dl></dd></dl></div><div class="abstract"><p class="title"><b>Abstract</b></p><p>This appendix is a manual for Qizx/open, a cut-down open-source version of Qizx.</p><p>It is a summary of the relevant sections of the above Qizx Manual.</p><p>These short tutorials assume you have at least a basic knowledge of the XML Query language.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e13487"></a>1.&nbsp;Getting Started with Qizx/open</h2></div></div></div><p>This section is a simplified version of the tutorial found in <a class="xref" href="getting_started.html" title="Chapter&nbsp;4.&nbsp;Getting started">Chapter&nbsp;4, <i>Getting started</i></a>.</p><p>To help experimenting and developing with XML Query, Qizx/open comes with two tools which make it easy to write and execute XML Query scripts:</p><div class="variablelist"><dl><dt><span class="term"><a class="link" href="qizxstudio.html" title="Qizx Studio Help">Qizx Studio</a></span></dt><dd><p>A graphic tool featuring a simple XML Query workbench with which you can write and execute XML Query scripts, and view the results.</p></dd><dt><span class="term"><a class="link" href="qizxtool.html" title="qizx">qizx</a></span></dt><dd><p>A command-line tool which can be used to execute XML Query script files.</p></dd></dl></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e13511"></a>1.1.&nbsp;Writing and running queries with Qizx Studio</h3></div></div></div><p>Qizx Studio currently provides a basic environment for editing and running XML Query queries.</p><h4><a name="d0e13516"></a>Starting Qizx Studio</h4><div class="itemizedlist"><ul type="disc"><li><p>On Windows, the directory bin inside the Qizx distribution contains an executable <span class="command"><strong>qizxstudio.exe</strong></span> (or <span class="command"><strong>qizxstudio.bat</strong></span>), that can be started directly by a double-click,</p></li><li><p>On Linux or Mac&nbsp;OS&nbsp;X or other Unix, the shell script <span class="command"><strong>bin/qizxstudio</strong></span> can be started from a terminal or from a graphical file manager.</p><p>Note that when started from a console, Qizx Studio accepts command-line arguments, for example to directly load a XML Query script in the editor. See the <a class="link" href="qizxstudio.html" title="Qizx Studio Help">reference documentation</a>.</p></li></ul></div><p>You should then see a window looking like this:</p><div class="figure"><a name="d0e13541"></a><p class="title"><b>Figure&nbsp;A.1.&nbsp;Qizx Studio first launch</b></p><div class="figure-contents"><div class="screenshot"><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="602"><tr><td><img src="resources/launch2.png" width="602" alt="Qizx Studio first launch"></td></tr></table></div></div></div></div><br class="figure-break"><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>In contrast with Qizx, there is only one tab in Qizx/open Studio: "<span class="guilabel">XQuery</span>" for entering and running queries.</p></div><p>Let us try this query (which is the contents of the file <code class="filename">qizxopen/queries/4.xq</code>):</p><pre class="programlisting"><span class="emphasis"><em>(: Find all books written by French authors. :)</em></span>
declare namespace t = "http://www.qizx.com/namespace/Tutorial";

declare variable $authors := collection("../../book_data/Authors/*.xml");
declare variable $books := collection("../../book_data/Books/*.xml");

for $a in $authors//t:author[@nationality = "France"]
   for $b in $books//t:book[.//t:author = $a/t:fullName]
return 
    $b/t:title</pre><p>Note that the directory <a class="ulink" href="../samples/programming/qizxopen/queries" target="_top"><code class="filename">docs/samples/programming/qizxopen/queries</code></a> contains the queries needed to illustrate this lesson.</p><div class="itemizedlist"><ul type="disc"><li><p>Use the menu <span class="guimenu">File</span> &#8594; <span class="guimenuitem">Open XQuery</span> to load the file mentioned above.</p><p>Note that you can also save to a file a query that you have entered or edited in Qizx Studio.</p><p>There is an history that allows running again former queries, so it is not necessary to save intermediary experiments.</p></li><li><p>Then you can use the button Execute to run the query.</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>The query above uses relative paths for the <code class="function">collection()</code> function. Depending how you launched Qizx Studio, you might have to replace the relative paths by absolute paths, otherwise you will get an error like "<code class="computeroutput">empty collection ../../book_data/Authors/*.xml</code>".</p></div><p>After execution, we should obtain something similar to this:</p><div class="figure"><a name="d0e13597"></a><p class="title"><b>Figure&nbsp;A.2.&nbsp;Result of a query</b></p><div class="figure-contents"><div class="screenshot"><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="602"><tr><td><img src="resources/query1.png" width="602" alt="Result of a query"></td></tr></table></div></div></div></div><br class="figure-break"></li><li><p>Notice that, in the picture above, the display mode of the right-side view has been changed to "<span class="guilabel">Data Model</span>", by using the <span class="guilabel">View</span> combo-box. This makes it easier to see the Data Model structure.</p><p>The result sequence contains one item, which is a element <code class="sgmltag-element">t:title</code> whose string value is "<code class="literal">Planet of the Apes</code>".</p><p>If for example we change the value "<code class="literal">France</code>" to "<code class="literal">US</code>" in the query, then we get a sequence of 8 items.</p><p>In the same directory there are a few other queries that you can also try.</p></li><li><p>The result items in the right-side view can be exported into a file using a button in the header. Notice that the resulting file will not in general be a well-formed XML document.</p></li><li><p>The <span class="guilabel">Diagnostic view</span> at bottom left contains messages, which can be simple information (execution times) or possible execution errors.</p><p>Compilation and execution errors have generally a link to the location in the source code. By clicking the link, the cursor moves to the location of the error in the editor view.</p></li><li><p>For more information about the editor and the query history, please see the <a class="link" href="qizxstudio.html" title="Qizx Studio Help">documentation of Qizx Studio</a>.</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e13648"></a>1.2.&nbsp;Running queries with the qizx command line tool</h3></div></div></div><p>The shell script <code class="filename">qizx</code> (<code class="filename">qizx.bat</code> on Windows) is also located in the <code class="filename">bin/</code> directory in the Qizx distribution. In the following we assume that this <code class="filename">bin/</code> directory is in the <code class="envar">PATH</code> environment variable.</p><p>In a terminal window, type the following command (the current directory is assumed to be <code class="filename">docs/samples/programming/qizxopen)</code>:</p><pre class="programlisting">qizx queries/4.xq </pre><p>Results are displayed on the console (or standard output) by default. The option <code class="option">-out</code> specifies an output file. Serialization options can be used to specify the output format.</p><p>The details of option switches can be found in the tool reference <a class="xref" href="qizxtool.html" title="qizx"><span class="refentrytitle">qizx</span>(1)</a>.</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e13684"></a>2.&nbsp;Programming with the Qizx/open API</h2></div></div></div><p>The API in Qizx/open is much simpler than in Qizx because it has not to deal with the management of XML libraries. This section is a simplified version of the tutorial found in <a class="xref" href="programming.html" title="Chapter&nbsp;10.&nbsp;Programming with the Qizx API">Chapter&nbsp;10, <i>Programming with the Qizx API</i></a>.</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e13691"></a>2.1.&nbsp;Compiling and running the code samples</h3></div></div></div><p>The code samples used to illustrate this chapter (class <code class="filename">OpenQuery.java</code>) are found in the <a class="ulink" href="../samples/programming/qizxopen" target="_top"><code class="filename">docs/samples/programming/qizxopen</code></a> directory. Files containing XQuery scripts are found in the <a class="ulink" href="../samples/programming/qizxopen/queries" target="_top"><code class="filename">docs/samples/programming/qizxopen/queries</code></a> sub-directory. These scripts are almost the same as those used in the Qizx tutorial, except that access to documents is performed through file paths instead of locations within an XML Library.</p><p>You'll need a recent version of <a class="ulink" href="http://ant.apache.org/" target="_top">ant</a>, a Java-based build tool to compile and run the codes samples.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e13712"></a>2.2.&nbsp;Creating a work session</h3></div></div></div><p>To create a XML Query session, we need a factory, which is an instance of the class <a class="ulink" href="../javadoc/com/qizx/api/XQuerySessionManager.html" target="_top"><code class="classname">XQuerySessionManager</code></a>. This class manages documents and XML Query modules, so it is recommended to use a single instance from which all sessions are created. The argument of the constructor is an URL used to locate XQuery modules: here it points to the current directory, but we could also use an HTTP URL pointing to a network server.</p><pre class="programlisting"> File currentDir = new File(System.getProperty("user.dir")); 
 XQuerySessionManager sm = new XQuerySessionManager(currentDir.toURL());

 XQuerySession session = sm.createSession();</pre><h4><a name="d0e13723"></a>Tuning the document cache:</h4><p>If you have to handle large documents or many documents in a Qizx/open application, it can be useful to tune the size of the document cache. This cache keeps the last documents parsed, so it avoids reloading documents in different sessions. However the cache detects a modification on a document in a file and reloads it.</p><p>Reminder: in Qizx/open, documents are always parsed into memory before processing. The functions that load documents are <a class="link" href="qizxopen.html#qop_fun_doc" title="3.2.&nbsp;Function fn:doc()"><code class="function">doc()</code></a> and <a class="link" href="qizxopen.html#qop_fun_collection" title="3.3.&nbsp;Function fn:collection()"><code class="function">collection()</code></a>. They are documented in the last section of this appendix: <a class="xref" href="qizxopen.html#qop_diffs" title="3.&nbsp;Differences between Qizx/open and Qizx">Section&nbsp;3, &#8220;Differences between Qizx/open and Qizx&#8221;</a>.</p><p>Use <code class="code">XQuerySessionManager.setTransientDocumentCacheSize(int size)</code> to specify a size in bytes for this cache. You can also use the system property <code class="constant">com.qizx.docpool.maxsize</code> (For example you would specify <code class="code">-Dcom.qizx.docpool.maxsize=100000000</code> on the command line).</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e13750"></a>2.3.&nbsp;Compiling and executing queries</h3></div></div></div><p>Compiling and running a XML Query script is fairly easy:</p><pre class="programlisting">Expression expr = session.compileExpression(script);<a class="co" name="qop_compileExpression" href="qizxopen.html#qop_compileExpression_2"><img src="images/callouts/1.png" alt="1" border="0"></a>
ItemSequence results = expr.evaluate();<a class="co" name="qop_evaluate" href="qizxopen.html#qop_evaluate_2"><img src="images/callouts/2.png" alt="2" border="0"></a>        
while (results.moveToNextItem()) {<a class="co" name="qop_results" href="qizxopen.html#qop_results_2"><img src="images/callouts/3.png" alt="3" border="0"></a>
    Item result = results.getCurrentItem();

    <em class="replaceable"><code>/*Do something with result.*/</code></em>
}</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a name="qop_compileExpression_2"></a><a href="#qop_compileExpression"><img src="images/callouts/1.png" alt="1" border="0"></a> </p></td><td valign="top" align="left"><p>First compile an XQuery expression using <a class="ulink" href="../javadoc/com/qizx/api/XQuerySession.html#compileExpression(java.lang.String)" target="_top"><code class="methodname">XQuerySession.compileExpression</code></a>. The argument <em class="parameter"><code>script</code></em> contains a XQuery query expression as a string. If no compilation errors (<a class="ulink" href="../javadoc/com/qizx/api/CompilationException.html" target="_top"><code class="classname">CompilationException</code></a>) are found, this returns an <a class="ulink" href="../javadoc/com/qizx/api/Expression.html" target="_top"><code class="interfacename">Expression</code></a> object.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a name="qop_evaluate_2"></a><a href="#qop_evaluate"><img src="images/callouts/2.png" alt="2" border="0"></a> </p></td><td valign="top" align="left"><p>Then evaluate the expression using <a class="ulink" href="../javadoc/com/qizx/api/Expression.html#evaluate()" target="_top"><code class="methodname">Expression.evaluate</code></a>. If no evaluation errors (<a class="ulink" href="../javadoc/com/qizx/api/EvaluationException.html" target="_top"><code class="classname">EvaluationException</code></a>) are found, this returns the results of the evaluation in the form of an <a class="ulink" href="../javadoc/com/qizx/api/ItemSequence.html" target="_top"><code class="interfacename">ItemSequence</code></a>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a name="qop_results_2"></a><a href="#qop_results"><img src="images/callouts/3.png" alt="3" border="0"></a> </p></td><td valign="top" align="left"><p>An <code class="interfacename">ItemSequence</code> allows to iterate over a sequence of <code class="interfacename">Item</code>s (see <a class="xref" href="programming.html#about_qizx_iterators" title="About Qizx iterators">About Qizx iterators</a>). A <a class="ulink" href="../javadoc/com/qizx/api/Item.html" target="_top"><code class="interfacename">Item</code></a> is either an atomic value or an XML <a class="ulink" href="../javadoc/com/qizx/api/Node.html" target="_top"><code class="interfacename">Node</code></a>.</p><p>Example (<a class="ulink" href="../samples/programming/qizxopen/queries/1.xq" target="_top"><code class="filename">1.xq</code></a>):</p><pre class="programlisting"><span class="emphasis"><em>(: Compute and return 2 + 3 :)</em></span>
2 + 3</pre><p>evaluates to an <code class="interfacename">ItemSequence</code> containing a single atomic value (5).</p><p>Example (<a class="ulink" href="../samples/programming/qizxopen/queries/3.xq" target="_top"><code class="filename">3.xq</code></a>):</p><pre class="programlisting"><span class="emphasis"><em>(: List all books by their titles. :)</em></span>
declare namespace t = "http://www.qizx.com/namespace/Tutorial";

collection("../../book_data/Books/*.xml")//t:book/t:title</pre><p>evaluates to an <code class="interfacename">ItemSequence</code> containing several <code class="sgmltag-attribute">t:title</code> element <code class="interfacename">Node</code>s.</p></td></tr></table></div><p>The <code class="classname">OpenQuery</code> class implements a simple command-line tool allowing to run queries.</p><p>Excerpts of <a class="ulink" href="../samples/programming/qizxopen/OpenQuery.java" target="_top"><code class="filename">OpenQuery.java</code></a>:</p><pre class="programlisting">    private static Expression compileExpression(XQuerySession session, 
                                                String script,
                                                QName[] varNames,
                                                String[] varValues) 
        throws IOException, QizxException
    {
        Expression expr;
        try {
            expr = session.compileExpression(script);
        }
        catch (CompilationException e) {
            Message[] messages = e.getMessages();
            for (int i = 0; i &lt; messages.length; ++i) {
                error(messages[i].toString());
            }
            throw e;
        }

        if (varNames != null) {
            for (int i = 0; i &lt; varNames.length; ++i) {
                expr.bindVariable(varNames[i], varValues[i], /*type*/ null);<a class="co" name="qop_bindVariable" href="qizxopen.html#qop_bindVariable_2"><img src="images/callouts/1.png" alt="1" border="0"></a>
            }
        }

        return expr;
    }</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a name="qop_bindVariable_2"></a><a href="#qop_bindVariable"><img src="images/callouts/1.png" alt="1" border="0"></a> </p></td><td valign="top" align="left"><p>An XQuery expression can be further parametrized by the use of variables. Example (<a class="ulink" href="../samples/programming/qizxopen/queries/101.xq" target="_top"><code class="filename">101.xq</code></a>):</p><pre class="programlisting"><span class="emphasis"><em>(: List all books containing the value of variable $searched 
   in their titles. :)</em></span>
declare namespace t = "http://www.qizx.com/namespace/Tutorial";

<span class="bold"><strong>declare variable $searched external;</strong></span>

collection("/Books")//t:book/t:title[contains(., <span class="bold"><strong>$searched</strong></span>)]</pre><p><a class="ulink" href="../javadoc/com/qizx/api/Expression.html#bindVariable(com.qizx.api.QName,%20java.lang.Object,%20com.qizx.api.ItemType)" target="_top"><code class="methodname">Expression.bindVariable</code></a> allows to give a variable its value, prior to evaluating the expression.</p></td></tr></table></div><p>Some queries may return thousands of results. Therefore, displaying just a range of results (e.g from result #100 to result #199 inclusive) is a very common need.</p><pre class="programlisting">    private static void evaluateExpression(Expression expr, 
                                           int from, int limit) 
        throws QizxException {
        ItemSequence results = expr.evaluate();
        if (from &gt; 0) {
            results.skip(from);<a class="co" name="qop_skip" href="qizxopen.html#qop_skip_2"><img src="images/callouts/1.png" alt="1" border="0"></a>
        }

        XMLSerializer serializer = new XMLSerializer();
        serializer.setIndent(2);

        int count = 0;
        while (results.moveToNextItem()) {
            Item result = results.getCurrentItem();

            System.out.print("[" + (from+1+count) + "] ");
            showResult(serializer, result);
            System.out.println();

            ++count;
            if (count &gt;= limit)<a class="co" name="qop_limit" href="qizxopen.html#qop_limit_2"><img src="images/callouts/2.png" alt="2" border="0"></a>
                break;
        }
        System.out.flush();
    }</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a name="qop_skip_2"></a><a href="#qop_skip"><img src="images/callouts/1.png" alt="1" border="0"></a> </p></td><td valign="top" align="left"><p><a class="ulink" href="../javadoc/com/qizx/api/ItemSequence.html#skip(int)" target="_top"><code class="methodname">ItemSequence.skip</code></a> allows to quickly skip the specified number of <code class="interfacename">Item</code>s.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a name="qop_limit_2"></a><a href="#qop_limit"><img src="images/callouts/2.png" alt="2" border="0"></a> </p></td><td valign="top" align="left"><p>This being done, you still need to limit the number of <code class="interfacename">Item</code>s you are going to display.</p></td></tr></table></div><p>In this lesson, we'll just show how to print the string representation of an <code class="interfacename">Item</code>.</p><pre class="programlisting">    private static void showResult(XMLSerializer serializer,
                                   Item result) 
        throws QizxException {
        if (!result.isNode()) {<a class="co" name="qop_isNode" href="qizxopen.html#qop_isNode_2"><img src="images/callouts/1.png" alt="1" border="0"></a>
            System.out.println(result.getString());<a class="co" name="qop_getString" href="qizxopen.html#qop_getString_2"><img src="images/callouts/2.png" alt="2" border="0"></a>
            return;
        }
        Node node = result.getNode();<a name="qop_getNode"></a><img src="images/callouts/3.png" alt="3" border="0">

        serializer.reset();
        String xmlForm = serializer.serializeToString(node);<a class="co" name="qop_serializeToString" href="qizxopen.html#qop_serializeToString_2"><img src="images/callouts/4.png" alt="4" border="0"></a>
        System.out.println(xmlForm);
    }</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a name="qop_isNode_2"></a><a href="#qop_isNode"><img src="images/callouts/1.png" alt="1" border="0"></a> <a href="#qop_getNode"><img src="images/callouts/3.png" alt="3" border="0"></a> </p></td><td valign="top" align="left"><p><a class="ulink" href="../javadoc/com/qizx/api/Item.html#isNode()" target="_top"><code class="methodname">Item.isNode</code></a> returns <code class="literal">true</code> for a <code class="interfacename">Node</code> and <code class="literal">false</code> for an atomic value. Similarly, <a class="ulink" href="../javadoc/com/qizx/api/Item.html#getNode()" target="_top"><code class="methodname">Item.getNode</code></a> returns a <code class="interfacename">Node</code> when the <code class="interfacename">Item</code> actually is a Node and <code class="literal">null</code> when the <code class="interfacename">Item</code> is an atomic value.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a name="qop_getString_2"></a><a href="#qop_getString"><img src="images/callouts/2.png" alt="2" border="0"></a> </p></td><td valign="top" align="left"><p><a class="ulink" href="../javadoc/com/qizx/api/Item.html#getString()" target="_top"><code class="methodname">Item.getString</code></a> returns the <em class="firstterm">string value</em> of an <code class="interfacename">Item</code> (whether <code class="interfacename">Node</code> or atomic value). What precisely is the string value of an <code class="interfacename">Item</code> is specified in the <a class="ulink" href="http://www.w3.org/TR/xquery/#id-typed-value" target="_top">XQuery standard</a>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a name="qop_serializeToString_2"></a><a href="#qop_serializeToString"><img src="images/callouts/4.png" alt="4" border="0"></a> </p></td><td valign="top" align="left"><p>The <a class="ulink" href="../javadoc/com/qizx/api/util/XMLSerializer.html#serializeToString(com.qizx.api.Node)" target="_top"><code class="methodname">XMLSerializer.serializeToString</code></a> convenience method is used to obtain the string representation of a <code class="interfacename">Node</code>.</p></td></tr></table></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e13995"></a>2.3.1.&nbsp;Compiling and running the code of this lesson</h4></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>Compile class <code class="classname">Query</code> by executing <span class="command"><strong>ant</strong></span> (see <a class="ulink" href="../samples/programming/qizxopen/build.xml" target="_top"><code class="filename">build.xml</code></a>) in the <code class="filename">docs/samples/programming/query/</code> directory.</p></li><li><p>Run <span class="command"><strong>ant&nbsp;run1</strong></span> in the <code class="filename">docs/samples/programming/qizxopen/</code> directory to perform this query:</p><pre class="programlisting"><span class="emphasis"><em>(: Find all books written by French authors. :)</em></span>
declare namespace t = "http://www.qizx.com/namespace/Tutorial";

for $a in collection("/Authors")//t:author[@nationality = "France"]
    for $b in collection("/Books")//t:book[.//t:author = $a/t:fullName]
    return 
        $b/t:title</pre><p>You can execute all the queries by running <span class="command"><strong>ant&nbsp;run_all</strong></span> in <code class="filename">docs/samples/programming/qizxopen/</code>.</p></li></ul></div></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="qop_diffs"></a>3.&nbsp;Differences between Qizx/open and Qizx</h2></div></div></div><div class="table"><a name="d0e14039"></a><p class="title"><b>Table&nbsp;A.1.&nbsp;Summary of functional differences between Qizx/open and Qizx</b></p><div class="table-contents"><table summary="Summary of functional differences between Qizx/open and Qizx" border="1"><colgroup><col width="50%" align="center"><col align="center" width="25%"><col align="center" width="25%"></colgroup><thead><tr><th align="center">&nbsp;</th><th align="center">Qizx</th><th align="center">Qizx/open</th></tr></thead><tbody><tr><td align="center">Basic features of the XML Query language</td><td align="center">yes</td><td align="center">yes</td></tr><tr><td align="center">Optional features of the XML Query language: Modules, Full Axis</td><td align="center">yes</td><td align="center">yes</td></tr><tr><td align="center">Persistent compressed document storage</td><td align="center">yes</td><td align="center">-</td></tr><tr><td align="center">In-memory XML documents</td><td align="center">yes</td><td align="center">yes</td></tr><tr><td align="center">Indexed queries</td><td align="center">yes</td><td align="center">-</td></tr><tr><td align="center">ACID transactions, hot backup</td><td align="center">yes</td><td align="center">-</td></tr><tr><td align="center">Full-text search</td><td align="center">yes</td><td align="center">yes, but not&nbsp;indexed</td></tr><tr><td align="center">Unlimited database size</td><td align="center">yes</td><td align="center">-</td></tr><tr><td align="center">General XQuery extension functions</td><td align="center">yes</td><td align="center">yes</td></tr><tr><td align="center">XML&nbsp;Library handling extension functions</td><td align="center">yes</td><td align="center">-</td></tr><tr><td align="center">Join optimizations</td><td align="center">yes</td><td align="center">yes</td></tr><tr><td align="center">Java Binding</td><td align="center">yes</td><td align="center">yes</td></tr><tr><td align="center">Java API</td><td align="center">yes</td><td align="center">yes (cut down)</td></tr><tr><td align="center">Source code of applications, API and utilities</td><td align="center">yes</td><td align="center">yes</td></tr><tr><td align="center">Source code of the XQuery engine</td><td align="center">-</td><td align="center">yes</td></tr></tbody></table></div></div><br class="table-break"><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e14159"></a>3.1.&nbsp;Java API</h3></div></div></div><p>In Qizx/open, the following elements are absent:</p><div class="itemizedlist"><ul type="disc"><li><p>in package <span class="package">com.qizx.api</span>: all classes whose name begins with '<code class="classname">Library</code>': <code class="classname">Library</code>, <code class="classname">LibraryMember</code>, etc,</p></li><li><p>in package <span class="package">com.qizx.api</span>: interface <code class="classname">AccessControl</code> and <code class="classname">User</code>, class <code class="classname">AccessControlException</code>,</p></li><li><p>package <span class="package">com.qizx.api</span>.util.accesscontrol&nbsp;.</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="qop_fun_doc"></a>3.2.&nbsp;Function fn:doc()</h3></div></div></div><div class="variablelist"><dl><dt><span class="term"><pre class="synopsis">fn:doc (<em class="replaceable"><code>$path-or-URL</code></em> as xs:string)
   as node()</pre></span></dt><dd><p>The standard <code class="function">doc()</code> function of XQuery.</p><p><b>Parameter <em class="replaceable"><code>$path-or-URL</code></em>:&nbsp;</b>This argument can be a simple file path or any URL supported by the Java run-time.</p><p><b>Returned value:&nbsp;</b>a <span class="emphasis"><em>document node</em></span>.</p><p>Example:</p><pre class="programlisting">doc("../book_data/Authors/iasimov.xml")
doc("http://www.axyana.com/qizx_tests/doc.cml")</pre></dd></dl></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="qop_fun_collection"></a>3.3.&nbsp;Function fn:collection()</h3></div></div></div><div class="variablelist"><dl><dt><span class="term"><pre class="synopsis">fn:collection (<em class="replaceable"><code>$path</code></em> as xs:string)
   as node()*</pre></span></dt><dd><p>This is the standard <code class="function">collection()</code> function of XQuery, slightly extended.</p><p><b>Parameter <em class="replaceable"><code>$path</code></em>:&nbsp;</b>This argument is a list of documents paths, separated by commas or semicolons.</p><div class="itemizedlist"><ul type="disc"><li><p>A normal path (without wildcard characters) is treated as per the function <code class="function">fn:doc()</code>. So it can either be part of a XML Library, or be an external document (file or URL) parsed on the fly.</p></li><li><p>If a path contains the wildcard characters <code class="function">*</code> or <code class="function">?</code>, it is treated as a file pattern and expanded. Attention: wildcard characters are currently accepted only in the file name, not in the path of the parent directory.</p><p>For example <code class="literal"><code class="code">collection("/home/data1/*.xml;/home/data2/*.xml")</code></code> can be expanded, while <code class="literal"><code class="code">collection("/home/*/*.xml;")</code></code> currently cannot be expanded (generates an error).</p></li><li><p>All of the documents must be accessible, or an error is raised.</p><p>If the expanded sequence of documents is empty, an error is raised.</p></li></ul></div><p><b>Returned value:&nbsp;</b>a sequence of <span class="emphasis"><em>document nodes</em></span>.</p><p>Example:</p><pre class="programlisting">collection("../book_data/Authors/*.xml;../book_data/Author blurbs/*.xhtml")</pre></dd></dl></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="qizxstudio.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="glossary.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Qizx Studio Help&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Glossary</td></tr></table></div></body></html>