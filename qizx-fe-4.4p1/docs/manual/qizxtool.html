<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>qizx</title><link rel="stylesheet" href="html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.73.1"><link rel="start" href="index.html" title="Qizx Manual"><link rel="up" href="tools.html" title="Part&nbsp;V.&nbsp;Tools"><link rel="prev" href="tools.html" title="Part&nbsp;V.&nbsp;Tools"><link rel="next" href="qizxstudio.html" title="Qizx Studio Help"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">qizx</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="tools.html">Prev</a>&nbsp;</td><th width="60%" align="center">Part&nbsp;V.&nbsp;Tools</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="qizxstudio.html">Next</a></td></tr></table><hr></div><div class="refentry" lang="en"><a name="qizxtool"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>qizx &#8212; Qizx command line tool</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><code class="command">qizx</code>   argument... </p></div></div><div class="refsection" lang="en"><a name="d0e14486"></a><h2>Description</h2><p>qizx is a simple command-line interface for administrative and development use.</p><p>It provides basic operations on XML libraries, in particular:</p><div class="itemizedlist"><ul type="disc"><li><p>Creating XML Libraries, and performing administrative tasks (like re-indexing, backup).</p></li><li><p>Importing XML documents into a Library, by parsing files or URL's.</p></li><li><p>Executing XQuery expressions from files.</p></li><li><p>Outputting the results of a XQuery execution to a file, with a number of options.</p></li><li><p>Exporting a XML document or a collection from a Library.</p></li></ul></div><p>The command-line option switches allow all these basic operations. For more complex problems, it is still possible to benefit of the full power of the XQuery language (and of extension functions provided by Qizx) by executing a script.</p></div><div class="refsection" lang="en"><a name="d0e14511"></a><h2>Options</h2><p>Option switches always start with a minus sign. They can be followed by an argument. The letter case is generally significant.</p><p>An argument not starting with '<code class="literal">-</code>' is considered a XQuery source file to be executed.</p><p><span class="emphasis"><em>Attention</em></span>: processing of options has changed in version 4.0. The order of options is no more relevant. This makes it simpler to use, but induces some limitations: some operations (import, backup) can be performed only once in a launch.</p><div class="refsection" lang="en"><a name="d0e14525"></a><h3>General</h3><div class="variablelist"><dl><dt><span class="term"><code class="option">-group</code> <em class="replaceable"><code>path</code></em>, </span><span class="term"><code class="option">-g</code> <em class="replaceable"><code>path</code></em></span></dt><dd><p>Specifies the location of a group of XML Libraries - or the address of a remote server.</p><div class="itemizedlist"><ul type="disc"><li><p><span class="command"><strong>Local Library group on disk</strong></span>: the path points to the root directory of the Group.</p></li><li><p><span class="command"><strong>Server</strong></span>: the path is an HTTP URL like http://somehost:8080/qizx/api.</p><p>A default installation of a Qizx Server would end with "/qizx/api" which corresponds to the Qizx REST API connector. But this path -&nbsp;of course the host and the port too&nbsp;- depend on the configuration of the server. See the Server installation documentation for more details.</p></li></ul></div></dd><dt><span class="term"><code class="option">-library</code> <em class="replaceable"><code>library_name</code></em>, </span><span class="term"><code class="option">-l</code> <em class="replaceable"><code>library_name</code></em></span></dt><dd><p>Specifies the name of a XML Library inside the selected group. The library must exist, unless the option <code class="option">-create</code> is used (see below), otherwise the tool will stop in error.</p><p>Most operations, like executing queries, require an XML Library.</p><p>In local group mode, the XML Library will be locked for exclusive access.</p></dd><dt><span class="term">-login <em class="replaceable"><code>username:password</code></em></span></dt><dd><p>Used when connecting to a Qizx server that requires authentication. Since the password may appear on the command-line, this is not recommended for the best security. You may want to use the following switch -auth:</p></dd><dt><span class="term">-auth <em class="replaceable"><code>secret-file</code></em></span></dt><dd><p>Specify login credentials read from a file for better security. If authentication is required, credentials will be read from this file. The file should contain the following values:</p><pre class="programlisting">login=admin                                                                                           
password=xxxx</pre><p>Of course the file should be protected from reading by other users.</p></dd></dl></div></div><div class="refsection" lang="en"><a name="d0e14601"></a><h3>Administration operations</h3><div class="variablelist"><dl><dt><span class="term"><code class="option">-create</code></span></dt><dd><p>Using this option, the group specified with option <code class="option">-group</code> is created if it does not exist, and the library specified with option <code class="option">-library</code> is created if it does not exist.</p><p>The option has no effect if both exist.</p><p>In client/server mode, only a Library can be created, this would not create a group since it is defined by the server.</p></dd><dt><span class="term"><code class="option">-import</code> <em class="replaceable"><code>collection</code></em> <em class="replaceable"><code>XML-file-or-directory</code></em>...<em class="replaceable"><code>XML-file-or-directory</code></em></span></dt><dd><p>Import one or several XML documents into a collection (the collection is created if it does not yet exist): documents are parsed (they must be valid), stored and automatically indexed.</p><p>Several XML file paths or directory paths can follow this option switch. Directories are scanned recursively, plain files encountered are considered XML and tentatively stored (the <code class="option">-include</code> and <code class="option">-exclude</code> options below can be used to filter files). A parsing error does not stop the load process.</p><p>The path of the collection can be a document pattern containing a character '<code class="literal">*</code>': this character is replaced by an integer incremented on each document stored, providing an automatic naming mechanism for new documents. For example:</p><pre class="programlisting">qizx -g mygroup -l mylib -import /a/collection/doc*.xml <em class="replaceable"><code>files</code></em>...</pre><p>would create documents <code class="literal">/a/collection/doc1027.xml</code>, <code class="literal">/a/collection/doc1028.xml</code>, <code class="literal">/a/collection/doc1030.xml</code>, etc. The numbers are of course guaranteed to be unique, and always increasing, but no other assumption can be made about their values.</p></dd><dt><span class="term"><code class="option">-include</code> <em class="replaceable"><code>suffix</code></em></span></dt><dd><p>Used together with <code class="option">-import</code>: restricts the importing operation to files ending with this suffix (case insensitive). Can be used before or after <code class="option">-import</code>, but must precede the XML file list. For example <code class="literal">-include&nbsp;.xml</code> would select only the files whose name ends with <code class="literal">.xml</code> or <code class="literal">.XML</code> or <code class="literal">.Xml</code>, etc.</p><p>This option can be repeated: <code class="literal">-include&nbsp;.xml&nbsp;-include&nbsp;.xsd</code> would select both files ending with <code class="literal">.xml</code> and <code class="literal">.xsd</code>. By default all plain files are taken, unless a <code class="option">-exclude</code> option is present (see below)</p></dd><dt><span class="term"><code class="option">-exclude</code> <em class="replaceable"><code>suffix</code></em></span></dt><dd><p>Used together with <code class="option">-import</code>: eliminates form a storing operation files ending with this suffix (case insensitive). Can be used before or after <code class="option">-import</code>, but must precede the XML file list. For example <code class="literal">-exclude&nbsp;.txt</code> would eliminate the files whose name ends with <code class="literal">.txt</code> or <code class="literal">.TXT</code>, etc.</p><p>This option can be repeated: <code class="literal">-exclude&nbsp;.jpg&nbsp;-exclude&nbsp;.png</code> would eliminate files ending with either <code class="literal">.jpg</code> or <code class="literal">.png</code>.</p></dd><dt><span class="term"><code class="option">-export</code> <em class="replaceable"><code>member_path</code></em></span></dt><dd><p>Exports a member of the selected library (Collection or Document) using its path.</p></dd><dt><span class="term"><code class="option">-indexing</code> <em class="replaceable"><code>path</code></em></span></dt><dd><p>Defines an Indexing specification for the Library. An Indexing specification is used for customizing the way XML documents are indexed in the Library. For more information, see <a class="xref" href="indexing.html" title="Chapter&nbsp;9.&nbsp;Configuring the indexing process">Chapter&nbsp;9, <i>Configuring the indexing process</i></a>.</p><p>If documents were already imported with a different indexing specification, it is strongly recommended to use the option <code class="option">-reindex</code> (see below) to rebuild indexes.</p></dd><dt><span class="term"><code class="option">-reindex</code></span></dt><dd><p>Rebuilds all the indexes from scratch, without altering documents.</p></dd><dt><span class="term"><code class="option">-optimize</code></span></dt><dd><p>Forces the compaction of indexes, without altering the contents of the Library.</p></dd><dt><span class="term"><code class="option">-delete-library</code></span></dt><dd><p>Using this option, a library is specified with <code class="option">-library</code> will be removed from the group and physically deleted.</p></dd><dt><span class="term"><code class="option">-delete</code> <span class="emphasis"><em>member_path</em></span></span></dt><dd><p>Deletes a member of the selected library (Collection or Document) using its path.</p></dd><dt><span class="term"><code class="option">-backup</code> <span class="emphasis"><em>backup_group_path</em></span></span></dt><dd><p>complete backup of the specified Library to the location specified: this location must correspond to a directory on a file-system, where a group will be created if necessary, and in which a XML Library with the same name will be created (if it already exists, it is first erased).</p><p>Example:</p><pre class="programlisting">qizx -c mygroup -library mylib -backup /backups/my-group</pre><p>This creates a backup group at <code class="filename">/backups/my-group</code> (if necessary), then copies the Library <code class="literal">mylib</code> into the backup group.</p></dd><dt><span class="term"><code class="option">-check</code> <em class="replaceable"><code>log_file</code></em></span></dt><dd><p>Performs a structural check of all the Libraries of the group and report errors to the log file. This is intended for debugging purpose.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>This operation is currently not able to repair a damaged XML Library.</p></div></dd></dl></div></div><div class="refsection" lang="en"><a name="d0e14841"></a><h3>XQuery execution and settings</h3><div class="variablelist"><dl><dt><span class="term"><code class="option">-q</code> <em class="replaceable"><code>query-file</code></em>, </span><span class="term"><em class="replaceable"><code>query-file</code></em></span></dt><dd><p>Executes the XQuery expression contained in that file(s). The <code class="option">-q</code> option switch is optional (it has to be used only if the file path starts with a dash, which is rarely the case). Several query files can be executed in order. Notice that if you specify the value of XQuery variables (option -D), this applies to all scripts, whatever their respective order.</p></dd><dt><span class="term"><code class="option">-base-uri</code> <em class="replaceable"><code>URI</code></em></span></dt><dd><p>Define the base URI for locating parsed XML documents. Unless a query redefines this base-URI, it will be used for resolving relative document locations as in the function <code class="function">doc()</code>.</p><p>This option has no effect when connecting to a server.</p></dd><dt><span class="term"><code class="option">-module-base-uri</code> <em class="replaceable"><code>URI</code></em></span></dt><dd><p>Define the base URI for locating XQuery modules.</p><p>This option has no effect when connecting to a server.</p></dd><dt><span class="term"><code class="option">-i</code> <em class="replaceable"><code>collection</code></em></span></dt><dd><p>Defines the ``Implicit Collection'' i.e the set of documents or Nodes used as search roots when a XQuery Path Expression has no explicit root.</p><p>For example the expression <code class="code">//ELEM</code> has no explicit root, while <code class="code">collection("/mycollec")//ELEM</code> has the explicit root <code class="code">collection("/mycollec")</code>, a Collection of the current XML Library.</p><p class="remark"><i><span class="remark">Using this option is quite useful, as it allows writing XQuery scripts which are independent on the actual data used as input. Furthermore it makes scripts more concise.</span></i></p><p>If the Implicit Collection is defined through this option, for example <code class="literal">-i /mycollec</code> , the expression <code class="code">//ELEM</code> is equivalent to <code class="code">collection("/mycollec")//ELEM</code>.</p><p>Values: acceptable values for this option are the same as the argument of function <a class="link" href="library_extensions.html#fn.collection">fn:collection</a> (Attention: this is different in Qizx/open):</p><div class="itemizedlist"><ul type="disc"><li><p>the path of a Document or a Collection inside an XML Library ,</p></li><li><p>a file path or an URL: for example <code class="uri">dir1/doc1.xml</code> or <code class="uri">http://foobar.com/docs/summary.xml</code></p></li><li><p>a file pattern: <code class="uri">dir/*.xml</code></p></li><li><p>a semicolon-separated list of the above elements: <code class="uri">dir1/*.xml;dir2/doc2.xsl</code></p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>If you want to use a single document, append a comma or semicolon after its path or URL.</p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The function <code class="function">collection()</code> without argument, or the deprecated XQuery function <code class="function">input()</code> can also be used instead of an implicit root.</p></div></dd><dt><span class="term"><code class="option">-domain</code> <em class="replaceable"><code>collection</code></em></span></dt><dd><p>Alias for option <code class="option">-i</code> above.</p></dd><dt><span class="term"><code class="option">-D</code><em class="replaceable"><code>variable_name</code></em>=<em class="replaceable"><code>value</code></em></span></dt><dd><p>Defines the value of a global variable. For example if the variable is declared like this:</p><pre class="programlisting">declare variable $output external;</pre><p>then the option <code class="literal">-Doutput=foo</code> initializes <code class="varname">$output</code> with the string value "<code class="literal">foo</code>".</p><p>If the variable is declared with a type, an attempt to cast the string value to the declared type is made.</p><p>If the variable is declared with an initial value, this value is overridden.</p></dd><dt><span class="term"><code class="option">--</code> <em class="replaceable"><code>argument</code></em> ... <em class="replaceable"><code>argument</code></em></span></dt><dd><p>The double dash switch is used to pass command-line arguments to a XQuery script. It stores all following command-line tokens into the predefined variable <code class="varname">$arguments</code>. For example:</p><pre class="programlisting">qizx myscript.xq -- arg1 arg2 arg3</pre><p>runs the script <code class="filename">myscript.xq</code> after putting the sequence of 3 string items ("<code class="literal">arg1</code>", "<code class="literal">arg2</code>", "<code class="literal">arg3</code>") into variable <code class="varname">$arguments</code>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Because of this option, the scripts are always executed after interpretation of all other options.</p></div></dd><dt><span class="term"><code class="option">-timezone</code> <em class="replaceable"><code>duration</code></em></span></dt><dd><p>Defines the <em class="glossterm">implicit timezone</em> in the dynamic XQuery context. The value must be in <code class="literal">xs:duration</code> form, for example <code class="literal">-timezone&nbsp;-PT5H</code>.</p><p>This option has no effect when connecting to a server.</p></dd><dt><span class="term"><code class="option">-collation</code> <em class="replaceable"><code>uri</code></em></span></dt><dd><p>Defines the default collation for string comparisons.</p><p>Collations are supported through Java collators based on a locale name, for example "<code class="literal">/en</code>" or "<code class="literal">/fr-CH</code>". There is currently no support for plugging user-defined collators.</p><p>Syntax of the URI of a collation:</p><div class="itemizedlist"><ul type="disc"><li><p>Leading slash (so that the URI is absolute, otherwise it could be dereferenced relatively to the base-uri property of the static context).</p></li><li><p>Name of a locale following the Java conventions.</p></li><li><p>An optional URI fragment (beginning with a '#') whose value is "primary", "secondary" or "tertiary", defining the "strength" of the collator (see the <a class="ulink" href="http://java.sun.com/j2se/1.4.2/docs/api/java/text/Collator.html" target="_top">Java documentation</a> for more details). The value "primary" is less specific than "tertiary".</p><p>If the strength is absent, it is in general equivalent to "tertiary".</p></li></ul></div><p>For example, the expression <code class="code">contains("The&nbsp;next&nbsp;caf&eacute;",&nbsp;"CAFE",&nbsp;"/en#primary")</code> should return <code class="code">true</code>, because the collation with strength primary ignores case and accents.</p><p>The special URIs <code class="classname">codepoint</code> and "<code class="uri">http://www.w3.org/2003/05/xpath-functions/collation/codepoint</code>" refer to the basic Unicode codepoint matching (or absence of collation). This is the default collation, unless redefined in the static context.</p></dd></dl></div></div><div class="refsection" lang="en"><a name="d0e15113"></a><h3>Output options</h3><div class="variablelist"><dl><dt><span class="term"><code class="option">-X</code><em class="replaceable"><code>option</code></em>=<em class="replaceable"><code>value</code></em></span></dt><dd><p>Defines a serialization option for result output. For example <code class="literal">-Xmethod=html</code> produces results in HTML markup.</p><p>For details of serialization options, see the documentation of the <code class="function">x:serialize()</code> XQuery extension function.</p></dd><dt><span class="term"><code class="option">-out</code> <em class="replaceable"><code>file</code></em></span></dt><dd><p>output the result of a XQuery expression to a file (defaults to standard output).</p></dd><dt><span class="term"><code class="option">-wrap</code></span></dt><dd><p>wraps the displayed results in description tags. For example with <code class="option">-wrap</code> the expression <code class="literal">1</code>, "<code class="literal">a</code>" would display:</p><pre class="programlisting">Query ? 1, "a"
&lt;?xml version='1.0' encoding='UTF-8'?&gt;
&lt;query-results&gt;
  &lt;item type="xs:integer"&gt;1&lt;/item&gt;
  &lt;item type="xs:string"&gt;a&lt;/item&gt;
&lt;/query-results&gt;</pre><p>instead of:</p><pre class="programlisting">Query ? 1, "a"
1 a
-&gt; 2 item(s)</pre></dd><dt><span class="term"><code class="option">-jt</code></span></dt><dd><p>trace use of Java extension functions (for debugging).</p><p>This option has no effect when connecting to a server.</p></dd><dt><span class="term"><code class="option">-tex</code></span></dt><dd><p>verbose display of run-time exceptions (for debugging).</p></dd></dl></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>In Qizx/open, only the query execution options and output options are available</p></div></div></div><div class="refsection" lang="en"><a name="d0e15188"></a><h2>Examples</h2><p>This section is an How-To for some common operations with the qizx command line tool:</p><div class="variablelist"><dl><dt><span class="term">Create a group with a single XML Library</span></dt><dd><pre class="programlisting">qizx -group D:\xmldb\group1 -library orders -create</pre><p>This creates a group in the directory <code class="filename">D:\xmldb\group1</code> (which must be non-existent or empty), containing a single XML Library named '<code class="literal">orders</code>'.</p></dd><dt><span class="term">Create an empty group</span></dt><dd><pre class="programlisting">qizx -group D:\xmldb\group1 -create</pre><p>This creates a group in the directory <code class="filename">D:\xmldb\group1</code>, without any XML Library inside.</p></dd><dt><span class="term">Connect to a server</span></dt><dd><pre class="programlisting">qizx -login me:mypassword -group http://localhost:8080/qizx/api script.xq</pre><p>This connects to a Qizx server and executes the script on this server. Most other commands and options can be used in this mode.</p><p>Authentication, if required, can be provided by option -login, or by -auth (use of a secret file), or would be read on the console.</p></dd><dt><span class="term">Import XML documents into an existing XML Library</span></dt><dd><pre class="programlisting">qizx -group D:\xmldb\group1 -library orders -import /2007/june c:\data\orders\june2007\*.xml</pre><p>This assumes that the group at <code class="filename">D:\xmldb\group1</code> already exists and contains a Library named '<code class="literal">orders</code>'. Then the specified XML documents are stored into the Collection <code class="literal">/2007/june</code>. For example the document <code class="filename">c:\data\orders\june2007\A.xml</code> will be stored in the library at <code class="literal">/2007/june/A.xml</code>.</p></dd><dt><span class="term">Create a group with a single XML Library and store XML documents</span></dt><dd><pre class="programlisting">qizx -group D:\xmldb\group1 -library orders -create -import /2007/june c:\data\orders\june2007\*.xml</pre><p>This is a combination of the previous commands: the group and library are created and immediately after the documents are stored into the Library '<code class="literal">orders</code>'.</p></dd><dt><span class="term">Import XML documents into an existing XML Library with filters</span></dt><dd><pre class="programlisting">qizx -group D:\xmldb\group1 -library data -import /2007/june -include .xml -include .xsl \
    c:\data\orders\june2007</pre><p>Assuming that the group at <code class="filename">D:\xmldb\group1</code> already exists and contains a Library named '<code class="literal">orders</code>', then all XML documents contained within directory <code class="filename">c:\data\orders\june2007</code> (at any depth), and whose name ends with <code class="literal">.xml</code> or <code class="literal">.xsl</code> are stored into the Collection <code class="literal">/2007/june</code>.</p><pre class="programlisting">qizx -group D:\xmldb\group1 -library data -import /2007/june -exclude .jpg \
    c:\data\orders\june2007</pre><p>Assuming that the group at <code class="filename">D:\xmldb\group1</code> already exists and contains a Library named '<code class="literal">orders</code>', then all XML documents contained within directory <code class="filename">c:\data\orders\june2007</code> (at any depth), and whose name does not end with <code class="literal">.jpg</code> are stored into the Collection <code class="literal">/2007/june</code>.</p></dd><dt><span class="term">Delete an XML Library within a group</span></dt><dd><pre class="programlisting">qizx -group D:\xmldb\group1 -library dataLib -delete-library</pre><p>Deletes the library '<code class="literal">dataLib</code>' (selected by <code class="literal">-library&nbsp;dataLib</code>) and all its contents. Beware, this operation is irreversible.</p></dd><dt><span class="term">Delete a Document or a Collection within a Library</span></dt><dd><pre class="programlisting">qizx -group D:\xmldb\group1 -library dataLib -delete /2007/june</pre><p>Deletes the collection <code class="literal">/2007/june</code> in library '<code class="literal">dataLib</code>' and all its contents (documents and sub-collections). Beware, this operation is irreversible.</p><pre class="programlisting">qizx -group D:\xmldb\group1 -library dataLib -delete /2007/june/order1.xml</pre><p>Deletes the document <code class="literal">/2007/june/order1.xml</code> in library '<code class="literal">dataLib</code>'. Beware, this operation is irreversible.</p></dd></dl></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="tools.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="tools.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="qizxstudio.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Part&nbsp;V.&nbsp;Tools&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Qizx Studio Help</td></tr></table></div></body></html>